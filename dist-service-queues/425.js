"use strict";(globalThis.webpackChunk_openmrs_esm_service_queues_app=globalThis.webpackChunk_openmrs_esm_service_queues_app||[]).push([[425],{9992:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(272),a=n.n(i),s=n(2609),o=n.n(s)()(a());o.push([e.id,".-esm-service-queues__transition-queue-entry-dialog__modalBody___C0CJU{padding-bottom:.5rem;margin-bottom:0rem}.-esm-service-queues__transition-queue-entry-dialog__p___mzejr{margin-bottom:.25rem;font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}","",{version:3,sources:["webpack://./src/transition-queue-entry/transition-queue-entry-dialog.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAGA,uEACE,oBCiBW,CDhBX,kBAAA,CAGF,+DACE,oBCOW,CCk1BT,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA",sourceRoot:""}]),o.locals={modalBody:"-esm-service-queues__transition-queue-entry-dialog__modalBody___C0CJU",p:"-esm-service-queues__transition-queue-entry-dialog__p___mzejr"};const u=o},6425:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var i=n(5206),a=n.n(i),s=n(8879),o=n.n(s),u=n(4924),l=n(9383),r=n(2870),c=n(8053),d=n(5326),m=n(5865),p=n(9192),v=n(1354),g=n.n(v),y=n(1583),_=n.n(y),A=n(7378),b=n.n(A),f=n(5993),C=n.n(f),E=n(4154),h=n.n(E),q=n(8141),k=n.n(q),U=n(9992),w={};w.styleTagTransform=k(),w.setAttributes=C(),w.insert=b().bind(null,"head"),w.domAPI=_(),w.insertStyleElement=h(),g()(U.Z,w);const S=U.Z&&U.Z.locals?U.Z.locals:void 0;var D,B=n(9561);!function(e){e.REQUEUED="Requeued"}(D||(D={}));const N=function(e){var t=e.queueEntry,n=e.closeModal,s=(0,u.useTranslation)().t,v=(0,r.useConfig)(),g=v.concepts.defaultTransitionStatus,y=null==t?void 0:t.identifiers.filter((function(e){var t;return v.defaultIdentifierTypes.includes(null==e||null===(t=e.identifierType)||void 0===t?void 0:t.uuid)})),_=o()((new Date).toISOString()).subtract(6,"month").toISOString(),A=(0,p.Wi)(null==t?void 0:t.patientUuid,_),b=A.upcomingAppointment,f=A.isLoading,C=(0,m.N)(null==t?void 0:t.patientUuid),E=C.visits,h=C.isLoading,q=!h&&E?(0,d.wP)(null==E?void 0:E.encounters,v.concepts.historicalObsConceptUuid):[],k=(0,B.Q)().mutateQueueEntries,U=(0,i.useCallback)((function(){var e,i=new Date;(0,c.zI)(null==t?void 0:t.visitUuid,null==t?void 0:t.queueUuid,null==t?void 0:t.queueUuid,null==t?void 0:t.queueEntryUuid,null==t?void 0:t.patientUuid,null==t||null===(e=t.priority)||void 0===e?void 0:e.uuid,g,i,null==t?void 0:t.sortWeight).then((function(e){201===e.status&&(0,c.Ny)(null==t?void 0:t.queue.name,null==t?void 0:t.visitQueueNumber,"serving").then((function(e){200===e.status&&((0,r.showSnackbar)({isLowContrast:!0,title:s("success","Success"),kind:"success",subtitle:s("patientAttendingService","Patient attending service")}),n(),k(),(0,r.navigate)({to:"${openmrsSpaBase}/patient/".concat(null==t?void 0:t.patientUuid,"/chart")}))}))}),(function(e){(0,r.showSnackbar)({title:s("queueEntryUpdateFailed","Error updating queue entry"),kind:"error",isLowContrast:!1,subtitle:null==e?void 0:e.message})}))}),[t]),w=(0,i.useCallback)((function(){(function(e,t,n){var i=new AbortController;return(0,r.openmrsFetch)("".concat(r.restBaseUrl,"/queue/").concat(t,"/entry/").concat(n),{method:"POST",headers:{"Content-Type":"application/json"},signal:i.signal,body:{priorityComment:e}})})(D.REQUEUED,null==t?void 0:t.queueUuid,null==t?void 0:t.queueEntryUuid).then((function(e){200===e.status&&((0,r.showSnackbar)({isLowContrast:!0,title:s("success","Success"),kind:"success",subtitle:s("patientRequeued","Patient has been requeued")}),n(),k())}),(function(e){(0,r.showSnackbar)({title:s("queueEntryUpdateFailed","Error updating queue entry"),kind:"error",isLowContrast:!1,subtitle:null==e?void 0:e.message})}))}),[]);return a().createElement("div",null,a().createElement(l.xBx,{closeModal:n,title:s("servePatient","Serve patient")}),a().createElement(l.fef,{className:S.modalBody},a().createElement("div",null,a().createElement("section",{className:S.modalBody},a().createElement("p",{className:S.p},s("patientName","Patient name")," :   ",null==t?void 0:t.name),(null==y?void 0:y.length)?y.map((function(e){var t;return a().createElement("p",{className:S.p},null==e||null===(t=e.identifierType)||void 0===t?void 0:t.display," :   ",null==e?void 0:e.identifier)})):"",a().createElement("p",{className:S.p},s("lastClinicalVisit","Last clinical visit")," :   ",h&&s("loading","Loading..."),!h&&!E&&s("none","None"),E&&(0,r.formatDatetime)((0,r.parseDate)(null==E?void 0:E.startDatetime))),(null==q?void 0:q.length)?q.map((function(e){return a().createElement("p",{className:S.p},e.concept.display," :   ",e.value.display)})):"",a().createElement("p",{className:S.p},s("tcaDate","Tca date")," :   ",f&&s("loading","Loading..."),!f&&!b&&s("none","None"),b&&(0,r.formatDatetime)((0,r.parseDate)(null==b?void 0:b.startDateTime)))),a().createElement(r.ExtensionSlot,{className:S.visitSummaryContainer,name:"previous-visit-summary-slot",state:{patientUuid:null==t?void 0:t.patientUuid}}))),a().createElement(l.mzw,null,a().createElement(l.zxk,{kind:"secondary",onClick:function(){return w()}},s("requeue","Requeue")),a().createElement(l.zxk,{onClick:function(){return U()}},s("serve","Serve"))))}}}]);